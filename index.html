<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Landing page dinâmica da Tytan Imóveis em Passo Fundo–RS. Descubra, compare e fale direto por WhatsApp." />
  <title>Landing MAS-NI – Imóveis Tytan</title>
  <style>
    /* seu CSS existente, sem manutenção interna */
    /* … (todo o seu <style> atual) … */
  </style>
</head>
<body>
  <header>
    <a href="./">
      <img src="assets/logos/tt-logo.png" alt="Logo Tytan Imóveis" loading="lazy" />
    </a>
  </header>
  <main>
    <section class="slider-container">
      <label for="valor-interesse">Faixa de valor de interesse:</label>
      <input
        type="range"
        id="valor-interesse"
        min="0"
        max="20000000"
        step="50000"
        value="500000"
        oninput="atualizarValor(this.value)"
      />
      <div id="valor-exibido">R$ 500.000</div>
    </section>
    <div id="imoveis-container"><!-- será preenchido via JS --></div>
  </main>
  <footer>© 2025 MAS-NI | Mauricio Silveira – CRECI 74302</footer>

  <script>
    const JSON_URL = './imoveis.json';
    let todosOsImoveis = [];

    fetch(JSON_URL)
      .then(r => r.json())
      .then(d => { todosOsImoveis = d.imobs; renderizarImoveis(todosOsImoveis); });

    function escapeRegExp(s='') { return s.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'); }
    function highlight(txt, w) {
      if(!w) return txt;
      const esc = escapeRegExp(w);
      return txt.replace(new RegExp(`(${esc})`,'gi'),'<span class="highlight">$1</span>');
    }

    function atualizarValor(v) {
      document.getElementById('valor-exibido')
        .textContent = `R$ ${Number(v).toLocaleString('pt-BR')}`;
      const num = Number(v);
      const list = num>0
        ? todosOsImoveis.filter(i=>i.valor<=num)
        : todosOsImoveis;
      renderizarImoveis(list);
    }

    function renderizarImoveis(list) {
      const c = document.getElementById('imoveis-container');
      c.innerHTML = list.length
        ? list.map(im=>renderImovel(im)).join('')
        : '<p>Nenhum imóvel disponível para esse valor.</p>';
    }

    function renderImovel(im) {
      const end = [im.endereco.rua,
                   im.endereco.unidade?`Unid. ${im.endereco.unidade}`:null,
                   im.endereco.bairro,
                   im.endereco.cidade]
                  .filter(Boolean).join(' – ');
      const pic = (im.fotos&&im.fotos[0])||'https://via.placeholder.com/120x80?text=Sem+foto';
      const gal = (im.fotos||[]).map((u,i)=>`<img src="${u}" alt="Foto ${i+1}" loading="lazy">`).join('')||
                  '<p>Sem imagens disponíveis.</p>';
      const specsArr = [
        `Perfil: ${im.perfil}`,
        `Área Terreno: ${im.terreno||'–'} m²`,
        `Área Const.: ${im.areaConstruida||'–'} m²`,
        `Vagas: ${im.vagas||0}`,
        `Lavabos: ${im.lavabos||0}`,
        `Elevador: ${im.elevador||'–'}`
      ];
      if(im.complemento) specsArr.push(`Complemento: ${im.complemento}`);
      const specs = specsArr.map(t=>`<div class="caracteristica">${t}</div>`).join('');
      const msg = encodeURIComponent(`Olá Mauricio, tenho interesse nesse imóvel (ID: ${im.id})`);

      return `
        <article class="imovel" onclick="this.classList.toggle('expanded')">
          <div class="summary">
            <img src="${pic}" alt="Foto de ${im.titulo}" loading="lazy">
            <div class="info">
              <h2>${highlight(im.titulo, im.palavraDestaque)}</h2>
              <p><strong>R$ ${im.valor.toLocaleString('pt-BR')}</strong></p>
              <p>${end}</p>
            </div>
          </div>
          <div class="details">
            <div class="galeria">${gal}</div>
            <ul class="info-geral">
              <li><strong>Endereço:</strong> ${end}</li>
              <li><strong>CEP:</strong> ${im.endereco.cep}</li>
              <li><strong>Próximo a:</strong> ${im.proximo||'–'}</li>
            </ul>
            <div class="caracteristicas">${specs}</div>
            <div class="cta">
              <a class="btn btn-whatsapp" href="https://wa.me/54999832413?text=${msg}" target="_blank">WhatsApp</a>
              <a class="btn-redes" href="https://www.facebook.com/MauricioSilveira1962/" target="_blank">Facebook</a>
              <a class="btn-redes" href="https://www.instagram.com/mascorretor" target="_blank">Instagram</a>
              <a class="btn-redes" href="https://www.threads.net/@mascorretor" target="_blank">Threads</a>
            </div>
          </div>
        </article>
      `;
    }
  </script>
</body>
</html>
